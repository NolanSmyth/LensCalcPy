# AUTOGENERATED! DO NOT EDIT! File to edit: ../nbs/00_pbh.ipynb.

# %% auto 0
__all__ = ['Pbh']

# %% ../nbs/00_pbh.ipynb 3
from .parameters import *
import numpy as np

# %% ../nbs/00_pbh.ipynb 4
class Pbh:
    """A class to represent a PBH population"""

    def __init__(self,
                m_pbh: float, # PBH mass in solar masses
                f_dm: float # PBH fraction of the DM density
                ):
        """Initialize the PBH population

        Args:
            m_pbh (float): PBH mass in solar masses
            f_dm (float): PBH fraction of the DM density
        """
        self.m_pbh = m_pbh
        if f_dm < 0 or f_dm > 1:
            raise ValueError("f_dm must be between 0 and 1")
        self.f_dm = f_dm
    
    def __str__(self) -> str:
        return f"PBH population with m_pbh={self.m_pbh} and f_dm={self.f_dm}"
    __repr__ = __str__

    def density(self, r: float) -> float:
        """PBH density at a given distance from the Milky Way center
        Using an NFW profile

        Args:
            r (float): distance in kpc

        Returns:
            float: PBH density in Msol/kpc^-3
        """
        return rhoc / ((r/rs)*1 + r/rs)**2 * self.f_dm
    
    def mass_enclosed(self, r: float) -> float:
        """PBH mass enclosed within a given distance from the Milky Way center

        Args:
            r (float): distance in kpc

        Returns:
            float: PBH mass in Msol
        """
        return 4*np.pi * rhoc * rs**3 * (np.log(r + r/rs) - (r/rs)/(1 + r/rs))
    
    def velocity_dispersion(self, r: float) -> float:
        """PBH velocity dispersion at a given distance from the Milky Way center

        Args:
            r (float): distance in kpc

        Returns:
            float: PBH velocity dispersion in km/s
        """
        return np.sqrt(G * self.mass_enclosed(r) / r) 
    
